<ion-view view-title="{{topic.title}}">
  <ion-nav-buttons side="left">
    <a class="button button-icon icon ion-ios-arrow-back" href="#tab/index"></a>
  </ion-nav-buttons>
  <ion-content>
    <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" refreshing-icon="ion-loading-c">
    </ion-refresher>

    <div>
      <ion-slide-box style="width:414px;" does-continue="true" auto-play="true" slide-interval="1000">
          <ion-slide ng-repeat="pic in topic.goods_pics">
              <img ng-src="{{img_prefix}}{{pic}}" style="width:414px;height:200px"  />
          </ion-slide>
          <ion-slide ng-repeat="pic in topic.goods_pics">
              <img ng-src="{{img_prefix}}/api/v1/file/image-anonymous/5537c98ade18237343129d66" style="width:414px;height:200px"  />
          </ion-slide>
          <ion-slide ng-repeat="pic in topic.goods_pics">
              <img ng-src="{{img_prefix}}/api/v1/file/image-anonymous/5536575c42825b3a02ded117" style="width:414px;height:200px"  />
          </ion-slide>
      </ion-slide-box>
      <span class="{{topic.goods_quality_degree | badge}}">{{topic.goods_quality_degree}}</span>
    </div>

    <div class="row">
      <div class="price col col50">
        <h3>
        <span class="assertive">￥ {{topic.goods_now_price}}</span>
        &nbsp;
        <del>￥ {{topic.goods_pre_price}}</del>
        </h3>
        <button class="button button-assertive button-small">接受侃价</button>
        <br />
        <a class="button button-clear button-assertive">
          <i class=" icon ion-ios-heart-outline"> </i> {{topic.collect_count + 0}}
        </a>
        &nbsp;<span class="visit-count">浏览 {{topic.visit_count + 0}}</span>
      </div>
      <div class="col col50 text-right">
        <div class="name-avatar">
          <img ng-src='{{topic.author.avatar}}' />
          <span>{{topic.author.name}}</span>
        </div>
        <div class="item-content"><i class="icon ion-ios7-location mr5"></i>{{topic.goods_exchange_location.address}}</div>
        <div class="item-note">
          距离1.5公里<br />
          <span am-time-ago="topic.update_at"></span>
        </div>
      </div>
    </div>
    <div class="row topic">
      <div class="col col90">
        <h5>宝贝详情</h4>
        <div class="topic-content" ng-bind-html="topic.content | link"></div>
      </div>
    </div>
    
    <div class="button-bar">
      <a class="button button-outline button-small ">出价（5）</a>
      <a class="button button-outline button-small active"> 留言（{{topic.replies.length}}）</a>
    </div>

    <ion-list class="replies">
      <ion-item class="item-loading" ng-if="topic.replies == undefined">
        <span ng-if="!loadError">
          加载中...
        </span>
        <span ng-if="loadError">
          加载失败
        </span>
      </ion-item>
      <ion-item ng-if="topic.replies.length == 0">
        暂无评论
      </ion-item>
      <ion-item class="item-avatar" ng-repeat="reply in topic.replies" ng-click="showActions(reply)">
        <img ng-src="{{reply.author.avatar}}">
        <p>
          <span ng-class="{'bold': reply.author.loginname == topic.author.loginname}">
            {{reply.author.name}}
          </span>
          <span class="item-note" am-time-ago="reply.create_at">
          </span>
          <span class="item-note cnode">
            <i class="icon ion-thumbsup"></i>
            <span ng-if="reply.ups.length > 0">{{reply.ups.length}}</span>
            &nbsp;
          </span>
        </p>
        <div class="reply-content" ng-bind-html="reply.content | link"></div>
      </ion-item>
    </ion-list>

  </ion-content>

  <ion-footer-bar ng-show="!showReply" ng-disabled="false" style="padding:0;margin:0">
    <button ng-click="showReply = true" class="button button-full button-stable" style="padding:0;margin:0">我要留言</button>
  </ion-footer-bar>
  <ion-footer-bar ng-show="showReply" class="bar-stable" keyboard-attach>
      <label class="item-input-wrapper light-bg">
        <input type="text" placeholder="回复" ng-model="replyData.content">
      </label>
      <button class="button button-small button-clear button-positive" ng-click="saveReply()">
        提交
      </button>
  </ion-footer-bar>
</ion-view>
