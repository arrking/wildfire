<!-- http://ionicframework.com/docs/api/directive/ionSideMenus/ -->
<ion-view hide-nav-bar="true">
    <ion-side-menus>
        <ion-side-menu-content>
          <ion-header-bar class="bar-dark">
              <div class="buttons">
                  <button class="button button-icon ion-navicon" menu-toggle="left"> {{menuTitle}}</button>
              </div>
              <h1 class="title" ng-click="endSearch()">{{tabTitle}}</h1>
              <input class="searchbox" ng-class="showSearch?'expanded':''" ng-model="query" type="text" placeholder="">
              <a class="button button-icon icon ion-ios7-search pull-right" ng-click="doSearch(query)"></a>
          </ion-header-bar>
          <ion-nav-view name="menuContent">
              <ion-content>

                <ion-refresher ng-if="topics.length > 0 || loadError" pulling-text="下拉刷新..." on-refresh="doRefresh()" refreshing-icon="ion-loading-c">
                </ion-refresher>

                <div class="list topics">
                  <div class="item col col-50 no-border" style="height:315px; float:left" ng-repeat="topic in topics">
                      <div class="item item-image">
                        <a ui-sref="item({itemId: topic.id})">
                          <img class="full-image " ng-src="{{img_prefix}}{{topic.goods_pics[0]}}" width="170px" height="194px" />
                          <span class="{{topic.goods_quality_degree | badge}}">{{topic.goods_quality_degree}}</span>
                        </a>
                        <div class="text-left padding-left padding-right padding-top">
                          <a ui-sref="item({itemId: topic.id})" class="topics-title"> <h3> {{topic.title}} </h3></a>
                          <h3 class="price">
                            <span class="assertive">￥ {{topic.goods_now_price}}</span>
                            &nbsp;
                            <del>￥ {{topic.goods_pre_price}}</del>
                          </h3>
                          <div class="clearfix dot-line"></div>
                          <div class="clearfix">
                            <div class="float-left"><span class="update-time" am-time-ago="topic.update_at"></span></div>
                            <div class="float-right">
                              <a class="button button-clear button-small">{{topic.reply_count}} <i class="icon ion-ios-chatboxes-outline"> </i></a>
                              <a class="button button-clear button-assertive button-small">{{topic.collect_count}} <i class=" icon ion-ios-heart-outline"> </i></a>
                            </div>
                          </div>
                        </div>
                      </div>
                  </div>
                </div>

                <!--
                  Loading icon of infinte-scroll not showing with collection-repeat
                  https://github.com/driftyco/ionic/issues/2376
                -->
                <ion-infinite-scroll on-infinite="loadMore()" distance="10%" icon="ion-loading-c" ng-if="hasNextPage && !loadError">
                </ion-infinite-scroll>
                <div class="item text-center padding">
                  <p>{{loadingMsg}}</p>                  
                </div>
              </ion-content>
          </ion-nav-view>
        </ion-side-menu-content>
        <ion-side-menu side="left">
            <ion-header-bar class="bar-assertive">
                <h1 class="title">分类</h1>
            </ion-header-bar>
            <ion-content>
                <ion-list>
                    <ion-item class="item item-icon-right topic-name-menu assertive {{currentTab==item.value?'stable-bg':''}}" menu-close ng-click="changeSelected(item)" ng-repeat="item in sideMenus" href="#/tab/index/{{item.value}}">
                        <i class="icon ion-ios7-arrow-right assertive" ng-if="currentTab==item.value"></i> {{item.label}}
                    </ion-item>
                </ion-list>
            </ion-content>
        </ion-side-menu>
    </ion-side-menus>
</ion-view>
